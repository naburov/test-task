# Тестовое задание
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/naburov/test-task/blob/master/%D0%A4%D0%BE%D1%80%D0%BF%D0%BE%D1%81%D1%82%2C_%D1%82%D0%B5%D1%81%D1%82%D0%BE%D0%B2%D0%BE%D0%B5_%D0%B7%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5.ipynb)

Создание простого детектора овальных объектов. 

## Использование
Обучение проводилось при помощи google colab. В ноутбуке описан весь процесс обучения, архитектура, функция потерь и т. д. Все остальные скрипты находятся в репозитории только для экспериментов с полученной моделью. 

Main.py позволяет протестировать модель. Скрипт получает на вход путь к исходному изображению и путь, куда нужно получить изображение после обработки нейросетью с указанными рамками овальных объектов. В процессе скрипт загружает предобученную модель из папки weights, делает предсказание и сохраняет исходное изображение с рамками. 
Перед использованием нужно:
1. Загрузить веса и скопировать их в папку weights. Ссылка на загрузку весов [Google Drive](https://drive.google.com/drive/folders/15UBqKx4wQ9Axi9x8ZS-CxnmjJJGCXOVA?usp=sharing).
2. Установить необходимые модули (Pillow, tensorflow 2.2.0, numpy).

Для использования необходимо выполнить команду: 
```python
python main.py -i "<path to input image>" -o "<path to output image> -c <confidence_threshhold>"
```
## Процесс обучения
В папке loss charts находятся графики обучения. Evaluation total loss - график значений функции потерь для изображений, на которых модель не тренировалась. Total loss - график функции потерь во время тренировки. Обучение проводилось на протяжении 15 эпох. 
